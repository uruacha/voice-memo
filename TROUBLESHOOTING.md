# 音声認識エラー トラブルシューティングガイド

## 修正内容

`app.js` のエラーハンドリングを強化しました：

### 改善点
1. **詳細なエラーメッセージ** - エラーの種類に応じて具体的な解決方法を表示
2. **ブラウザサポート検出** - Web Speech API対応状況を明確に表示
3. **エラー時の安定性向上** - try-catchブロックでクラッシュを防止
4. **ログ出力の強化** - ブラウザコンソールで詳細情報を確認可能

## エラーメッセージと対処法

### 1. 「マイクアクセスが拒否されました」
**原因**: ブラウザがマイクアクセスをブロックしている

**対処法**:
1. ブラウザのアドレスバー左側のアイコン（🔒）をクリック
2. 「マイク」の設定を「許可」に変更
3. ページをリロード

### 2. 「このブラウザは音声認識に対応していません」
**原因**: Web Speech API非対応のブラウザ

**対処法**:
- **Chrome** または **Microsoft Edge** を使用してください
- Firefoxは現在Web Speech APIに対応していません
- Safariは限定的な対応です

### 3. 「ネットワークエラー」
**原因**: インターネット接続の問題

**対処法**:
- インターネット接続を確認
- Web Speech APIはオンライン専用です
- オフラインでは動作しません

### 4. 「このページではWeb Speech APIが利用できません」
**原因**: HTTPでアクセスしている（HTTPSが必要）

**対処法**:
- **ローカルテスト**: `http://localhost:8000` は利用可能
- **本番環境**: HTTPSでホスティング（GitHub Pages、Vercelなど）

## 確認手順

### ステップ1: ブラウザをリロード
```
Ctrl + Shift + R (Windows)
Cmd + Shift + R (Mac)
```

### ステップ2: ブラウザコンソールを開く
```
F12 キーを押す
または
右クリック → 「検証」→ 「Console」タブ
```

### ステップ3: 録音を開始
1. 「リアルタイム」モードを選択
2. マイクボタンをクリック
3. マイクアクセスを「許可」

### ステップ4: エラーメッセージを確認
- 画面上のメッセージ（トースト通知）
- APIステータス表示
- ブラウザコンソールのログ

## よくある問題と解決策

### 問題: 音声を認識しない
**解決策**:
- マイクが正しく接続されているか確認
- 別のアプリ（Zoom、Skypeなど）でマイクをテスト
- ブラウザの設定で正しいマイクデバイスを選択

### 問題: すぐにエラーになる
**解決策**:
- ブラウザを最新版にアップデート
- シークレット/プライベートモードで試す
- ブラウザのキャッシュをクリア

### 問題: 認識精度が低い
**解決策**:
- **Groq Whisper API** に切り替える（高精度）
- 静かな環境で録音
- マイクの近くで話す

## デバッグ情報の取得方法

エラーが解決しない場合、以下の情報を確認してください：

1. **ブラウザ**: Chrome/Edge/Safari のバージョン
2. **OS**: Windows/Mac/iPhone のバージョン
3. **エラーメッセージ**: コンソールに表示されるエラー
4. **アクセスURL**: http://localhost:8000 か HTTPS URL か

### ブラウザコンソールのログ例
```
🎤 音声メモアプリ初期化完了
Speech recognition started
🎯 リアルタイム認識中...
```

エラーの場合:
```
Speech recognition error: not-allowed
❌ マイクアクセスが拒否されました
```

## 代替案: Groq Whisper API

Web Speech APIで問題が続く場合は、**Groq Whisper API**（高精度モード）をお試しください：

### 設定手順
1. https://console.groq.com/keys でAPIキーを取得（無料）
2. アプリの設定（⚙️）でAPIキーを入力
3. 「高精度 Groq」モードを選択
4. 録音完了後に自動で文字起こし

### メリット
- ブラウザ非依存
- 高精度な日本語認識
- リアルタイムではないが、より確実

## 現在のサーバー

ローカル開発サーバーが **http://localhost:8000** で起動中です。

ブラウザでアクセスして、修正版をお試しください。

## まとめ

✅ **エラーハンドリング強化済み**
- 詳細なエラーメッセージ表示
- ブラウザサポート検出
- 安定性向上

🔧 **推奨事項**
- Chrome/Edge ブラウザを使用
- マイクアクセスを許可
- インターネット接続を確認
- HTTPSでホスティング（本番環境）
